# üì¶ `pm` ‚Äî –ü—Ä–æ—Å—Ç–æ–π –ø–∞–∫–µ—Ç–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä –Ω–∞ Go

`pm` ‚Äî —ç—Ç–æ –ª–µ–≥–∫–æ–≤–µ—Å–Ω—ã–π CLI-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è —É–ø–∞–∫–æ–≤–∫–∏, –∑–∞–≥—Ä—É–∑–∫–∏ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–∞–∫–µ—Ç–æ–≤ –ø–æ SSH. –ù–∞–ø–∏—Å–∞–Ω –Ω–∞ Go. –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π, –¥–∏—Å—Ç—Ä–∏–±—É—Ü–∏–∏ –±–∏–Ω–∞—Ä–Ω–∏–∫–æ–≤ –∏–ª–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–º–∏ –ø–∞–∫–µ—Ç–∞–º–∏.

---

##  –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- –£–ø–∞–∫–æ–≤–∫–∞ —Ñ–∞–π–ª–æ–≤ –≤ `.tar.gz` –ø–æ –º–∞—Å–∫–∞–º
- –ó–∞–≥—Ä—É–∑–∫–∞ –∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ –ø–∞–∫–µ—Ç–æ–≤ —á–µ—Ä–µ–∑ **SSH/SFTP**
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ **–≤–µ—Ä—Å–∏–æ–Ω–Ω–æ—Å—Ç–∏**: `>=1.10`, `<=2.0`, —Ç–æ—á–Ω—ã–µ –≤–µ—Ä—Å–∏–∏
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ **JSON –∏–ª–∏ YAML**
- –ò—Å–∫–ª—é—á–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –ø–æ —à–∞–±–ª–æ–Ω—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, `*.tmp`)
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ **SSH-–∫–ª—é—á–µ–π** 
- –û–¥–∏–Ω –±–∏–Ω–∞—Ä–Ω—ã–π —Ñ–∞–π–ª ‚Äî –Ω–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π


- ## üì• –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### —á–µ—Ä–µ–∑ Makefile


```bash
git clone https://github.com/FozardBC/package-manager
cd pm

make          # –ü–æ–∫–∞–∑–∞—Ç—å —Å–ø—Ä–∞–≤–∫—É (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
make build    # –°–æ–±—Ä–∞—Ç—å –±–∏–Ω–∞—Ä–Ω–∏–∫: pm + –î–æ–±–∞–≤–∏—Ç—å –±–∏–Ω–∞—Ä–Ω–∏–∫ –≤ /usr/bin
make mod      # –û–±–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: go mod tidy
make clean    # –£–¥–∞–ª–∏—Ç—å –±–∏–Ω–∞—Ä–Ω–∏–∫

```

- # –†—É—á–∫–∞–º–∏
```bash
# –ö–ª–æ–Ω–∏—Ä—É–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone https://github.com/FozardBC/package-manager
cd pm

# –°–æ–∑–¥–∞–π—Ç–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –¥–ª—è SSH key
mkdir vault
# –ü–æ–º–µ—Å—Ç–∏—Ç–µ –≤ vault –∫–ª—é—á

# –û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
# (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –°–æ–∑–¥–∞–π—Ç–µ .env –∏ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç–µ
# (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
export SSH_HOST=localhost
export SSH_USER=root
export SSH_PORT=2222
export SSH_KEY_PATH=./vault/test-key/test-key

# –°–æ–±–µ—Ä–∏—Ç–µ –±–∏–Ω–∞—Ä–Ω–∏–∫
go build -o pm

# (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –î–æ–±–∞–≤—å –≤ PATH
sudo mv pm /usr/local/bin/
```

üõ†Ô∏è –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
–°–æ–∑–¥–∞—ë—Ç –∞—Ä—Ö–∏–≤ –∏–∑ —Ñ–∞–π–ª–æ–≤ –ø–æ –∫–æ–Ω—Ñ–∏–≥—É –∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –µ–≥–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä.
```
pm create <—Ñ–∞–π–ª-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏>
```
–°–∫–∞—á–∏–≤–∞–µ—Ç –∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –ø–∞–∫–µ—Ç—ã, —É–∫–∞–∑–∞–Ω–Ω—ã–µ –≤ –∫–æ–Ω—Ñ–∏–≥–µ.

```
pm update <—Ñ–∞–π–ª-—Å–ø–∏—Å–∫–∞>
```

üìÅ –§–æ—Ä–º–∞—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
packet.json ‚Äî –ö–∞–∫–∏–µ —Ñ–∞–π–ª—ã —É–ø–∞–∫–æ–≤–∞—Ç—å
```json
{
  "name": "myapp",
  "ver": "1.10", # –≤–µ—Ä—Å–∏—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ x.xx
  "targets": [
    "./configs/*.yaml",
    {
      "path": "./bin/*", 
      "exclude": ["*.tmp", "dev-*"] # –∏—Å–∫–ª—é—á–µ–Ω–∏—è
    }
  ]
}
```

packages.json ‚Äî –ö–∞–∫–∏–µ –ø–∞–∫–µ—Ç—ã —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
```json
{
  "packages": [
    { "name": "myapp", "ver": ">=1.10" },
    { "name": "utils", "ver": "1.5" },
    { "name": "logger", "ver": "<=2.0" }
  ]
}
```

üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
–ü–æ SSH-–∫–ª—é—á—É
–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è (—Ö–æ—Å—Ç, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –ø—É—Ç—å –∫ –∫–ª—é—á—É) –º–æ–∂–Ω–æ –∑–∞–¥–∞–≤–∞—Ç—å –≤ –∫–æ–¥–µ –∏–ª–∏ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è.


## –î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —á–µ—Ä–µ–∑ —Ç–µ—Å—Ç–æ–≤—ã SSH-—Å–µ—Ä–≤–µ—Ä –≤ Docker
```bash
docker run -d --name ssh-test -p 2222:22 rastasheep/ubuntu-sshd:18.04

#–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–ª—é—á–∞ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker cp test_key.pub ssh-test-server:/tmp/id_rsa.pub

docker exec -it ssh-test-server /bin/bash

mkdir -p /root/.ssh
cat /tmp/id_rsa.pub >> /root/.ssh/authorized_keys
chmod 700 /root/.ssh
chmod 600 /root/.ssh/authorized_keys
exit
```

```
EXPORT PM_SSH_HOST=localhost
EXPORT PM_SSH_USER=root
EXPORT PM_SSH_PORT=2222
EXPORT PM_SSH_KEY_PATH=./vault/#ssh-key

#–∏–ª–∏ —Å–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª .env –≤ –∫–æ—Ä–Ω–µ–≤–æ–π –ø–∞–ø–∫–µ

go build -o .

sudo mv pm /usr/local/bin/

pm ..
```

